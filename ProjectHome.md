generate query code rather than write it